# -*- coding: utf-8 -*-
"""22201670-Sachith Gunawardane-IT8x20-Assessment2.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1fBKSbW8pcQz9g1iSbwqQ-CxwYnBV5TPa

# **IT8x20 Special Topic in Information Technology (Machine Learning and AI)**

# Assignment 2

**Student ID:** 22201670

**Student Name:** Sachith M. Gunawardane

## Connect Google Drive

It was decided that Google Drive will be used to 

* Save Model in HDF5 format (prerequisite)
* Hold video files (prerequisite)
* Images for scenarios
"""

from google.colab import drive
drive.mount('/content/gdrive/', force_remount=True)

"""## Read Video (mp4) and Extract Images

Below function (capture_frames) will have following functionality 

* Input parameters 
    1.   Path to video files  
    2.   Path to image base folder 
    3.   Number of images required to be captured 

* Video folder can hold subfolders. 

* Image folders will be created per video. Video name will be used as last/final folder to place images. (Manual creation of folders not required)

* Returns following as List
    1.   Scenario
    2.   Path to Scenario
    3.   Class Name based on Video file name 
"""

# Global parameters for image/frame capturing 
video_folder = '/content/gdrive/MyDrive/Assignment2/Videos'
image_folder = '/content/gdrive/MyDrive/Assignment2/Images'
no_of_frames = 100

import os
import numpy as np
import cv2 as cv

# function to extract frames from videos
# this will create image folder and place all images for each scenario 
# Most important is the list (scenario) return by this function because it been used to retrieve images 
# If images are already generated, no need to run this function. U can get scenarios from save list in google drive 
def capture_frames(path_for_video, path_for_images, no_of_frames):

  scenario = []
  scenario_path = []
  class_name = []

  for file_path in os.walk(path_for_video):
    # Check folder contain files 
    if len(file_path[2]) > 0:
      # Loop each file 
      for filename in file_path[2]:
        folder_for_images = file_path[0]+ '/' + filename[0:len(filename)-4]
        folder_for_images = folder_for_images.replace(path_for_video, path_for_images)

        # if not exists, create folder structure to hold images 
        if not os.path.exists(folder_for_images):
          os.makedirs(folder_for_images)

        # Read the movie 
        videoCap = cv.VideoCapture(file_path[0]+'/'+filename)

        #capture number of frames per second available in video 
        fps = videoCap.get(cv.CAP_PROP_FPS)
        #capture number of total frames available 
        totFrames = videoCap.get(cv.CAP_PROP_FRAME_COUNT)
        interval = (totFrames - 50) // no_of_frames

        # Read frames from video
        # start from 50 to skip intial frames  
        next_frame = 50
        for count in range(1, no_of_frames + 1):
          videoCap.set(cv.CAP_PROP_POS_FRAMES, int(next_frame))
          success, image = videoCap.read()
          if success:
            imageName = folder_for_images +'/' + filename[0:len(filename)-4] + '%d.jpg' % count
            cv.imwrite(imageName, image)
          
            next_frame = next_frame + interval
            if next_frame > totFrames:
              next_frame = totFrames
        
        scenario.append( filename[0:len(filename)-4])
        scenario_path.append(folder_for_images)
        class_name.append('new_without_mask' if 'without' in filename else 'new_with_mask')

       
  return [np.array([scenario, scenario_path, class_name]).T]

scenario = []

# Important: Run only if images folder or images were not extrcted 
# This section take 5 to 6 min 
scenario = capture_frames(video_folder, image_folder, no_of_frames)

"""## Important 

The "scenario" variable is used throughout the code get,
* Scenario name (e.g.: Sunny with Mask, Sunny without Mask)
* The folder path for the scenario with all relevant images. 
* Class name 

This "scenario" variable/parameter is created while capturing frames from video files. Therefore, for ease of use, I have saved this list on Google drive and retrieved it so that we don't have to run "capture_frame" function every time.
"""

import pickle
print(type(scenario))
print(scenario)

# Important: prerequisite to run this is block 5 scenario creation from capture_frames function 
# Save list to file 
with open('/content/gdrive/MyDrive/Assignment2/Miscellaneous/scenario_list.pkl','wb') as f:
  pickle.dump(scenario, f)

# Load list from file 
with open('/content/gdrive/MyDrive/Assignment2/Miscellaneous/scenario_list.pkl','rb') as f:
  scenario = pickle.load(f)

print(type(scenario))
print(scenario)

"""Function call to capture_frames creates 
* folders for each scenario
* 100 images/frames from video into those scenarios 
* return matrix with all scenarios. First row for example

 ['Cloudy_withMask'
 '/content/gdrive/MyDrive/Assignment2/Images/Cloudy_withMask'
 'new_with_mask']

**Folder structure**

![image.png](data:image/png;base64,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)

## Load Libraries
"""

import pandas as pd
import matplotlib.pyplot as plt
from termcolor import colored
import tensorflow as tf
from tensorflow.keras.applications.mobilenet_v2 import MobileNetV2
from tensorflow.keras import Sequential
from tensorflow.keras.layers import Flatten, Dense
from tensorflow.keras.preprocessing import image_dataset_from_directory
from tensorflow.keras.preprocessing.image import ImageDataGenerator
from tensorflow.keras.optimizers import Adam
from keras.models import load_model
from keras.utils.vis_utils import plot_model
from sklearn.metrics import confusion_matrix, classification_report
import seaborn as sns
from google.colab.patches import cv2_imshow
from glob import glob 

from tensorflow.keras.applications.resnet_v2 import ResNet101V2
from tensorflow.keras.applications.vgg19 import VGG19
from tensorflow.keras.applications.vgg16 import VGG16
from keras.applications.inception_v3 import InceptionV3
from tensorflow.keras.applications import DenseNet201

from tensorflow.keras.callbacks import EarlyStopping, ModelCheckpoint

from IPython.display import clear_output

import warnings
warnings.filterwarnings('ignore')

"""## Load Custom Pre-Trained Model 

The model uses MobileNet2 as its backbone and has been trained on a dataset published on Kaggle. 

[Link to Dataset used for training.](https://www.kaggle.com/datasets/prasoonkottarathil/face-mask-lite-dataset)

This dataset is a collection of 20000 images in 2 different classes, each class having 10000. All the images with the face mask are scrapped from google search and all the images without the face mask are preprocessed from the CelebFace dataset created on Kaggle.   
"""

#model_path_mobilenet = '/content/gdrive/MyDrive/Assignment2/Model/mobilenet.h5'
#model_path_resnet = '/content/gdrive/MyDrive/Assignment2/Model/resnet101v2.h5'
#model_path_vgg19 = '/content/gdrive/MyDrive/Assignment2/Model/vgg19.h5'
model_path_vgg16 = '/content/gdrive/MyDrive/Assignment2/Model/vgg16.h5'
#model_path_densenet = '/content/gdrive/MyDrive/Assignment2/Model/densenet.h5'

model = load_model(model_path_vgg16)

"""### Model Details"""

print("Total Params:", model.count_params())
model.summary()

model_plot_path = '/content/gdrive/MyDrive/Assignment2/Model/my_model_plot.png'
plot_model(model, to_file=model_plot_path, show_shapes=True, show_layer_names=True)

!pip install visualkeras

import visualkeras
visualkeras.layered_view(model, legend=True) # without custom font

"""## Load Images based on Scenarios for Prediction"""

# Constants and common parameters 
IMG_SIZE = 256
class_names = ['new_with_mask','new_without_mask']

"""## Data Augmentation

Videos were captured to have a single person in the frame covering 30% - 50% of the frame. This allows the foreground to have a person and the background to be any other object. 

Initial prediction on based image (30% person and 70% background) shows that the model fails to classify images correctly. All images were classified as “new_without_mask” which is kind of default outcome when system is not able to predict. 

Reason to failure was obvious when you investigate training dataset of the model. Training dataset is with grayscale images with close portrait of person. 

Therefore, pre-processing of images was needed before sending in model. Considering assignment parameters following experiments were preformed, 

**Experiment 1:**

Crop images to hold person with less background and send to model. 

*Cropping:*

It was important to detect person in the image to perform cropping. 

*	Using cv2.cascadeClassifier with 'haarcascade_frontalface_default.xml', 'haarcascade_eye.xml' failed. Face detection did not work when person is waring mask. Without detecting face boundary, it difficult isolate eyes position from the return values of eye detection. Due to these issues using cv2.cascadeClassifier was drop for this purpose.  

* Finally, it was decided to use another model with transfer learning to detect face boundaries. SSD (res10_300x300_ssd_iter_140000_fp16.caffemodel) was use to identify face coordinates and crop image. 

**Experiment 2:**

Perform Bluer,  Grayscale, image Intensity and Sharpening augmentation  on top of image return by experiment 1. 

**Experiment 3:**

Perform Bluer, contrast, brightness, Grayscale, image Intensity and Sharpening augmentation  on top of image return by experiment 1. Contrast and brightness augmentation is the extra step in experiment 3


"""

# Augmentation function 
def image_augmentation(exp, img):
  ''' This  is Augmentation function 
  Input Parametes
     exp : Integer (Values expected is 1, 2, 3)
     img : image (return by cv2.imread, numpy.ndarray)
  Return Parameters 
     img : image (numpy.ndarray) augmented image based on experiment define
  for example experiment 2 request, function will perform code for experiment 1 and 2'''

  # Face Detection using DNN Net
  def detectFaceOpenCVDnn(net, frame, conf_threshold=0.7):
    
    top_buffer = 100
    buttom_buffer = 50
    left_right_buffer = 50 
    
    frameHeight = frame.shape[0]
    frameWidth = frame.shape[1]
    blob = cv.dnn.blobFromImage(frame, 1.0, (300, 300), [104, 117, 123], False, False,)
    
    net.setInput(blob)
    detections = net.forward() 
    
    #Loop to find correct coordinate with based on confident
    for i in range(detections.shape[2]):
      confidence = detections[0, 0, i, 2]
      if confidence > conf_threshold:
        x1 = int(detections[0, 0, i, 3] * frameWidth)
        y1 = int(detections[0, 0, i, 4] * frameHeight)
        x2 = int(detections[0, 0, i, 5] * frameWidth)
        y2 = int(detections[0, 0, i, 6] * frameHeight)

        top=x1
        right=y1
        bottom=x2-x1
        left=y2-y1
        a = right - top_buffer
        if a < 0: 
          a = 0
        elif a > frameHeight:
          a = frameHeight

        b = right + left + buttom_buffer
        if b < 0: 
          b = 0
        elif b > frameWidth:
          b = frameWidth

        c =  top - left_right_buffer
        if c < 0: 
          c = 0
        elif c > frameHeight:
          c = frameHeight -10


        d = top + bottom  + left_right_buffer
        if d < 0: 
          d = 0
        elif d > frameWidth:
          d = frameWidth -10


        frame = frame[a : b , c: d] 



    return frame
 
  # Experiment 1
  # crop image
  # load face detection model from Google Drive 
  modelFile = "/content/gdrive/MyDrive/Assignment2/SSD/res10_300x300_ssd_iter_140000_fp16.caffemodel" 
  configFile = "/content/gdrive/MyDrive/Assignment2/SSD/deploy.prototxt.txt"

  net = cv.dnn.readNetFromCaffe(configFile, modelFile)
  net.setPreferableBackend(cv.dnn.DNN_BACKEND_CUDA)
  net.setPreferableTarget(cv.dnn.DNN_TARGET_CUDA)

  frame = cv.resize(img, (640, 480))
  frame = detectFaceOpenCVDnn(net, frame)

  # Add Blue 
  if exp in (2,3):
    hsv = cv.cvtColor(frame, cv.COLOR_BGR2HSV)
    # Create a mask based on medium to high Saturation and Value
    # These values can be changed (the lower ones) to fit your environment
    mask = cv.inRange(hsv, (0, 75, 40), (180, 255, 255))
    # We need a to copy the mask 3 times to fit the frames
    mask_3d = np.repeat(mask[:, :, np.newaxis], 3, axis=2)
    # Create a blurred frame using Gaussian blur
    blurred_frame = cv.GaussianBlur(frame, (25, 25), 0)
    # Combine the original with the blurred frame based on mask
    frame = np.where(mask_3d == (255, 255, 255), frame, blurred_frame)
  
  #contrast and brightness
  if exp == 3:
    
    # Define the alpha and beta values for contrast and brightness adjustment
    alpha = 1  # contrast
    beta = 30  # brightness

    # Adjust the contrast and brightness of the image
    frame = cv.convertScaleAbs(frame, alpha=alpha, beta=beta)



  # Add Grayscale, Intensity and Sharpening 
  if exp in (2,3):
    # convert to grayscale of each frames
    frame = cv.cvtColor(frame, cv.COLOR_BGR2GRAY)

    # convert data type
    frame = frame.astype('float32')

    # shift pixel intensity by a constant
    intensity_shift = 100
    frame += intensity_shift

    # another option is to use a factor value > 1:
    # gray *= factor_intensity

    # clip pixel intensity to be in range [0, 255]
    frame = np.clip(frame, 0, 255)

    # change type back to 'uint8'
    frame = frame.astype('uint8')

    # Create the sharpening kernel
    kernel = np.array([[-1,-1,-1], [-1,9,-1], [-1,-1,-1]])
    # Apply the sharpening kernel to the image using filter2D
    frame = cv.filter2D(frame, -1, kernel)
  
 

  return frame

# Create Images for Experiment

def create_experiment_images(exp):
  for condition in scenario[0]:
    org_folder_path = condition[1]

    new_sub_fol = 'Images/Experiment' + str(exp)
    new_fol_path = org_folder_path.replace('Images', new_sub_fol)

    #create folder if not exists 
    if not os.path.exists(new_fol_path):
      os.makedirs(new_fol_path) 
    
    #read images for processing 
    filenames = glob(org_folder_path+ '/*.jpg')
    for filename in filenames:
      frameOrig = cv.imread(filename)
      # call augmentation 
      augImage = image_augmentation(exp,frameOrig)

      cv.imwrite(filename.replace('Images', new_sub_fol), augImage)


  return None

# Important 
# Run this only if Experiment images were not created in Google Drive 
# You can verify by going to '/content/gdrive/MyDrive/Assignment2/Images' path and checking follwing folders
# Experiment1 , Experiment2 and Experiment3 
# each of the above folders will have subfolders for scenario and images under those 
# This function take 8 to 10 min to run

# Create images for all 3 experiments 
for i in range(1,4):
  create_experiment_images(i)

"""### Create Dataset for Prediction


"""

#create dataset for prediction 
def make_dataset(scenario, exp):

  scenario_name = scenario[0]
  path_to_scenario = scenario[1]
  new_sub_fol = 'Images/Experiment' + str(exp)
  path_to_scenario = path_to_scenario.replace('Images', new_sub_fol)
  class_label = class_names.index(scenario[2])
   
  def parse_image(filename):
    image = tf.io.read_file(filename)
    image = tf.image.decode_jpeg(image, channels=3)
    image = tf.image.resize(image, [IMG_SIZE, IMG_SIZE])
    image = tf.reshape(image,[1, 256, 256, 3])
    image = image/255.0
    return image
  
  filenames = glob(path_to_scenario+ '/*.jpg')
  labels = [class_label for i in range(len(filenames))]

  filenames_ds = tf.data.Dataset.from_tensor_slices(filenames)
  images_ds = filenames_ds.map(parse_image, num_parallel_calls=tf.data.experimental.AUTOTUNE)
  labels_ds = tf.data.Dataset.from_tensor_slices(labels)

  ds = tf.data.Dataset.zip((images_ds, labels_ds))
  
  return ds

"""### Predict each scenario for experiment """

def predict_for_experiment(exp):
  
  df = pd.DataFrame()
  
  for condition in scenario[0]:
    scenario_ds  = make_dataset(condition, exp)
    
    # Predict with the new dataset 
    pred_ds = model.predict(scenario_ds)
    pred_labels = np.argmax(pred_ds, axis = 1)

    # Extract actual label from dataset 
    actual_labels = []
    for image, label in scenario_ds:
      actual_labels.append(label.numpy())

    actual_labels = np.array(actual_labels)

    # Plot confusion matrix for each scenario
    cm = confusion_matrix(actual_labels, pred_labels)

    plt.figure(figsize=(9,9))
    sns.heatmap(cm, annot=True, fmt=".3f", linewidths=.5, square = True, cmap = 'Blues_r', yticklabels=class_names, xticklabels=class_names)
    plt.ylabel('Actual label')
    plt.xlabel('Predicted label')
    plt.title('Experiment-'+str(exp) +'-' + condition[0] , size = 15)

    print(classification_report(actual_labels, pred_labels,labels = [0, 1], target_names=class_names))

    df[condition[0] + '_Actual'] = actual_labels
    df[condition[0] + '_Predict'] = pred_labels 

  return df

# function call for all 3 experiment 
# and output of the experiments will be saved to excel file in Google Drive 
# This section take 5 to 6 min to run

excel_path = '/content/gdrive/MyDrive/Assignment2/Excel'

#create folder if not exists 
if not os.path.exists(excel_path):
  os.makedirs(excel_path)


df_experiment_1 = predict_for_experiment(1)
df_experiment_2 = predict_for_experiment(2)
df_experiment_3 = predict_for_experiment(3)

# create an ExcelWriter object
writer = pd.ExcelWriter(excel_path +'/results.xlsx')
 
# write each DataFrame to a different sheet in the Excel file
df_experiment_1.to_excel(writer, sheet_name='Experiment_1', index=False)
df_experiment_2.to_excel(writer, sheet_name='Experiment_2', index=False)
df_experiment_3.to_excel(writer, sheet_name='Experiment_3', index=False)

# save the Excel file
writer.save()

"""# Image verification 

Following section will allow individual image to be verified with model 
"""

def img_preprocessing(path):
    sample_mask_img = cv.imread(path)
    sample_mask_img = cv.resize(sample_mask_img,(256,256))
    plt.imshow(sample_mask_img)
    sample_mask_img = np.reshape(sample_mask_img,[1,256,256,3])
    sample_mask_img = sample_mask_img/255.0
    res = np.argmax(model.predict(sample_mask_img))
    print('            ', class_names[res])

img_preprocessing('/content/gdrive/MyDrive/Assignment2/Images/Experiment3/Indoor_Natural_withMask/Indoor_Natural_withMask10.jpg')

img_preprocessing('/content/gdrive/MyDrive/Assignment2/Images/Experiment2/Indoor_Artificial_withoutMask/Indoor_Artificial_withoutMask13.jpg')

"""# Important 

Do not run below code. 
It's to bring training dataset to current session 
in case if you want to do any verification 
"""

# Important 
# Following code is only required when you want to being training dataset for verification 

!pip install opendatasets
import opendatasets as od

od.download("www.kaggle.com/datasets/pranavsingaraju/facemask-detection-dataset-20000-images")

img_preprocessing('/content/facemask-detection-dataset-20000-images/new_with_mask/with-mask-default-mask-seed0005.png')

img_preprocessing('/content/facemask-detection-dataset-20000-images/new_without_mask/seed0020.png')